<div class="admin-layout">
  <app-admin-sidebar />
  
  <div class="main-content">
    <app-admin-header />
    
    <div class="content-area">

      <div class="controls-card">
        <div class="controls-row">
          <div class="search-box">
            <span class="material-icons">search</span>
            <input
              type="text"
              placeholder="Search by name or SKU..."
              [(ngModel)]="searchTerm"
              (input)="applyFilters()"
              class="search-input"
            />
          </div>

          <div class="filter-controls">
            <select 
              [(ngModel)]="selectedCategory" 
              (change)="applyFilters()"
              class="filter-select"
            >
              <option value="">All Categories</option>
              <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
            </select>

            <select 
              [(ngModel)]="selectedStatus" 
              (change)="applyFilters()"
              class="filter-select"
            >
              <option value="">All Status</option>
              <option value="Available">Available</option>
              <option value="Low Stock">Low Stock</option>
              <option value="Unavailable">Unavailable</option>
            </select>

            <button class="btn btn-secondary" (click)="clearFilters()" *ngIf="searchTerm || selectedCategory || selectedStatus">
              <span class="material-icons">clear</span>
              Clear
            </button>
          </div>
        </div>

        <div class="results-info">
            <p>Showing <strong>{{ filteredProducts.length }}</strong> of <strong>{{ products.length }}</strong> products</p>
            <button class="btn btn-primary" (click)="openAddProduct()">
                <span class="material-icons">add</span>
                Add New Product
            </button>
        </div>
      </div>

      <div class="products-table-card">
        <div class="table-container">
          <table class="products-table">
            <thead>
              <tr>
                <th>PRODUCT</th>
                <th>CATEGORY</th>
                <th>PRICE</th>
                <th>STOCK</th>
                <th>STATUS</th>
                <th>FLAGS</th>
                <th>ACTIONS</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let product of filteredProducts" 
                  class="product-row" 
                  (click)="editProduct(product)"
                  [class.active-row]="editingProduct?.id === product.id">
                <td>
                  <div class="product-info-cell">
                    <img [src]="product.image" [alt]="product.name" class="product-thumb" />
                    <div class="product-texts">
                      <p class="product-name">{{ product.name }}</p>
                      <p class="product-sku">{{ product.brand }} â€¢ SKU: {{ product.sku }}</p>
                    </div>
                  </div>
                </td>
                <td>
                  <span class="category-tag">{{ product.category }}</span>
                </td>
                <td>
                  <span class="product-price">${{ product.price.toFixed(2) }}</span>
                </td>
                <td>
                  <span class="stock-count" [ngClass]="{
                    'stock-low': product.stock < 10 && product.stock > 0,
                    'stock-out': product.stock === 0
                  }">
                    {{ product.stock }}
                  </span>
                </td>
                <td>
                  <app-badge [status]="product.status" />
                </td>
                <td>
                  <div class="flags-container">
                    <span *ngIf="product.isFeatured" class="flag-pill featured">FEAT</span>
                    <span *ngIf="product.isNew" class="flag-pill new">NEW</span>
                  </div>
                </td>
                <td>
                  <div class="action-buttons">
                    <span class="material-icons edit" (click)="editProduct(product)">edit</span>
                    <span class="material-icons delete" (click)="deleteProduct(product)">delete</span>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div id="product-form-section">
        <app-product-form 
          *ngIf="isFormOpen" 
          [productData]="editingProduct"
          [categories]="categories"
          (save)="saveProduct()"
          (cancel)="closeForm()">
        </app-product-form>
      </div>
    </div>
  </div>
</div>