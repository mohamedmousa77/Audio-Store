<app-client-header />

<main class="category-page">

  <!-- Hero Section - Only show if products exist -->
  @if (!loading() && products.length > 0) {
  <section class="category-hero" [style.background-image]="'url(' + categoryImage() + ')'">
    <div class="hero-overlay">
      <div class="hero-content">
        <h1 class="category-title animate-fade-in">{{ categoryName }}</h1>
        <p class="category-description animate-fade-in-delayed">{{ categoryDescription() }}</p>
      </div>
    </div>
  </section>
  }
  <!-- Filters Section - Only show if products exist -->
  @if (!loading() && products.length > 0) {
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <div class="filter-actions-bar">
      <div class="filter-controls-wrapper">
        <button (click)="toggleFilters()" class="btn-filters" [class.active]="isFiltersOpen()">
          <span class="material-symbols-outlined">{{ isFiltersOpen() ? 'close' : 'tune' }}</span>
          <span>{{ translations().categorySection.filterTitle }}</span>
        </button>

        <div class="horizontal-filters-container" [class.open]="isFiltersOpen()">
          <div class="filter-group-inline">
            <select class="custom-select-small" [(ngModel)]="sortBy" (change)="applySort()">
              <option value="default">{{ translations().categorySection.sortTitle }}</option>
              <option value="featured">{{ translations().categorySection.sortOptions.featured }}</option>
              <option value="newest">{{ translations().categorySection.sortOptions.newest }}</option>
              <option value="price-low-high">{{ translations().categorySection.sortOptions.priceLowHigh }}</option>
              <option value="price-high-low">{{ translations().categorySection.sortOptions.priceHighLow }}</option>
            </select>
          </div>

          <div class="filter-group-inline">
            <div class="flex gap-2">
              <button (click)="applyFilters()" class="chip-mini">Under $100</button>
              <button (click)="applyFilters()" class="chip-mini">$100 - $500</button>
            </div>
          </div>

          <div class="filter-group-inline">
            <select class="custom-select-small" [(ngModel)]="selectedBrand" (change)="applyFilters()">
              <option value="">{{ translations().categorySection.filterByBrand }}</option>
              @for (brand of availableBrands; track brand) {
              <option [value]="brand">{{ brand }}</option>
              }
            </select>
          </div>
        </div>
      </div>
    </div>
    @if (!loading()) {
    <div class="products-grid mt-8 ml-2">
      @for (product of products; track product.id) {
      <app-product-card [product]="product" />
      }
    </div>
    }

    @if (loading()) {
    <div class="loading-container">
      <div class="loader"></div>
    </div>
    }
  </div>
  }
  <!-- Empty State - Show when no products -->
  @if (!loading() && products.length === 0) {
  <div class="empty-state-container">
    <div class="empty-state-content">
      <span class="material-symbols-outlined empty-icon">inventory_2</span>
      <h2>{{ translations().categorySection.emptyCategoryTitle }}</h2>
      <p>{{ translations().categorySection.emptyCategorySubtitle }}</p>

      <div class="empty-state-actions">
        <a routerLink="/" class="btn-primary">
          <span class="material-symbols-outlined">home</span>
          {{ translations().categorySection.backToHomepage }}
        </a>
      </div>
    </div>
  </div>

  <!-- Show other categories using category-showcase component -->
  @if (otherCategories.length > 0) {
  <app-category-showcase [categories]="otherCategories" />
  }
  }

</main>

<app-client-footer />