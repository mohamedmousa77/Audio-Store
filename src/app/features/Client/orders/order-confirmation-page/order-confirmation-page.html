<app-client-header></app-client-header>

<main class="confirmation-bg">
  <div class="container-premium">

    <!-- LOADING STATE -->
    @if (loading()) {
    <div class="state-card">
      <div class="loader-circle"></div>
      <p>{{ translations().common.loading }}...</p>
    </div>
    }

    <!-- ERROR STATE -->
    @if (!loading() && error()) {
    <div class="state-card">
      <span class="material-symbols-outlined error-icon">sentiment_very_dissatisfied</span>
      <h2>{{ translations().orders.orderNotFound }}</h2>
      <p>{{ translations().orders.orderNotFoundMessage }} <strong>{{ orderNumber() }}</strong>.</p>
      <button class="btn-primary-custom" (click)="continueShopping()">{{ translations().common.continueShopping
        }}</button>
    </div>
    }

    <!-- SUCCESS STATE -->
    @if (!loading() && !error() && order()) {
    <div class="confirmation-layout">

      <!-- HERO SECTION - Success Message -->
      <section class="hero-success-card">
        <div class="check-wrapper">
          <span class="material-symbols-outlined">check_circle</span>
        </div>
        <h1>{{ translations().orders.thankYou }}</h1>
        <p class="hero-text"> {{ translations().orders.orderPlaced }}
          <strong>#{{ order()!.orderNumber }}</strong> {{ translations().orders.successfully }}.
        </p>
        <div class="hero-buttons">
          <button class="btn-orange-filled" (click)="continueShopping()">
            {{ translations().orders.returnToShopping }}
          </button>
          <button class="btn-white-outline" (click)="downloadInvoice()">
            {{ translations().orders.downloadInvoice }}
          </button>
        </div>
      </section>

      <!-- MAIN GRID LAYOUT -->
      <div class="order-grid">

        <!-- LEFT COLUMN - Items and Details -->
        <div class="left-col">

          <!-- ITEMS ORDERED SECTION -->
          <section class="premium-card">
            <div class="card-header">
              <h3>{{ translations().orders.itemsOrdered }}</h3>
              <span class="count-pill">{{ order()!.items.length }} {{ translations().orders.items }}</span>
            </div>
            <div class="items-container">
              @for (item of order()!.items; track item.id) {
              <div class="product-row">
                <img [src]="item.productImage" [alt]="item.productName" class="product-image" />
                <div class="product-info">
                  <p class="p-name">{{ item.productName }}</p>
                  <p class="p-qty">{{ translations().cart.quantity }}: {{ item.quantity }}</p>
                </div>
                <div class="product-price">
                  €{{ item.subtotal.toFixed(2) }}
                </div>
              </div>
              }
            </div>
          </section>

          <!-- SHIPPING & PAYMENT ROW -->
          <div class="address-payment-row">

            <!-- SHIPPING ADDRESS -->
            <section class="premium-card">
              <h4 class="card-title">
                <span class="material-symbols-outlined">local_shipping</span>
                {{ translations().checkout.shippingAddress }}
              </h4>
              <div class="address-box">
                <p>
                  <strong>
                    {{ order()!.customerFirstName }}
                    {{ order()!.customerLastName }}
                  </strong>
                </p>
                <p>{{ order()!.shippingStreet }}</p>
                <p>
                  {{ order()!.shippingPostalCode }}
                  {{ order()!.shippingCity }}
                </p>
                <p>{{ order()!.shippingCountry }}</p>
              </div>
            </section>

            <!-- PAYMENT METHOD -->
            <section class="premium-card">
              <h4 class="card-title">
                <span class="material-symbols-outlined">payments</span>
                {{ translations().checkout.paymentMethod }}
              </h4>
              <div class="payment-box">
                <!-- <p>{{ order()!.paymentMethod || translations().orders.payUponReceipt }}</p> -->
                <span class="badge-payment">{{ translations().orders.payUponReceipt }}</span>
              </div>
            </section>
          </div>
        </div>

        <!-- RIGHT COLUMN - Order Summary Sidebar -->
        <aside class="right-col">
          <div class="summary-premium-card">
            <h3>{{ translations().checkout.orderSummary }}</h3>

            <div class="summary-lines">
              <div class="s-line">
                <span>{{ translations().cart.subtotal }}</span>
                <span>€{{ order()!.subtotal.toFixed(2) }}</span>
              </div>
              <div class="s-line">
                <span>{{ translations().checkout.shipping }}</span>
                <span class="text-green">€{{ order()!.shippingCost.toFixed(2) }}</span>
              </div>
              <div class="s-line">
                <span>{{ translations().orders.taxEst }}</span>
                <span>€{{ order()!.tax.toFixed(2) }}</span>
              </div>
            </div>

            <div class="s-divider"></div>

            <!-- TOTAL -->
            <div class="s-total">
              <div class="total-label-group">
                <span class="total-title">{{ translations().cart.total }}</span>
                <span class="total-note">{{ translations().checkout.includesTaxes }}</span>
              </div>
              <span class="total-price-val">€{{ order()!.totalAmount.toFixed(2) }}</span>
            </div>

            <!-- ORDER STATUS -->
            <div class="estimate-box">
              <span class="material-symbols-outlined">info</span>
              <div class="estimate-text">
                <p>{{ translations().orders.orderStatus }}</p>
                <strong>{{ getStatusText(order()!.orderStatus) }}</strong>
              </div>
            </div>
          </div>
        </aside>
      </div>
    </div>
    }
  </div>
</main>

<app-client-footer></app-client-footer>