<div class="orders-section">
  <!-- Header -->
  <div class="section-header">
    <div class="section-title">
      <h2>Order History</h2>
      <p>Track your past orders and their status</p>
    </div>
    <div class="date-filter">
      <label for="dateRange" class="filter-label">Last</label>
      <select id="dateRange" class="filter-select" [(ngModel)]="selectedDateFilter"
        (change)="onDateFilterChange($any($event.target).value)">
        <option value="all">All Orders</option>
        <option value="today">Today</option>
        <option value="week">This Week</option>
        <option value="month">This Month</option>
      </select>
    </div>
  </div>

  <!-- Loading State -->
  @if (loading()) {
  <div class="loading-state">
    <div class="spinner"></div>
    <p>Loading your orders...</p>
  </div>
  }

  <!-- Error State -->
  @if (error() && !loading()) {
  <div class="error-alert">
    <span class="material-symbols-outlined">error</span>
    <div>
      <strong>Error</strong>
      <p>{{ error() }}</p>
    </div>
  </div>
  }

  <!-- Orders List -->
  @if (!loading() && filteredOrders().length > 0) {
  <div class="orders-list">
    @for (order of filteredOrders(); track order.id) {
    <div class="order-card">
      <!-- Order Header -->
      <div class="order-header">
        <div class="order-info">
          <div class="info-group">
            <label class="info-label">ORDER ID</label>
            <span class="order-id">#{{ order.orderNumber }}</span>
          </div>
          <div class="info-group">
            <label class="info-label">DATE</label>
            <span class="order-date">{{ formatDate(order.orderDate) }}</span>
          </div>
          <div class="info-group">
            <label class="info-label">TOTAL</label>
            <span class="order-total">{{ formatPrice(order.totalAmount) }}</span>
          </div>
          <div class="info-group">
            <label class="info-label">STATUS</label>
            <span class="status-badge" [ngClass]="getStatusColor(order.orderStatus)">
              {{ getStatusText(order.orderStatus) }}
            </span>
          </div>
        </div>

        <!-- View Details Link -->
        <button class="view-details-btn" (click)="viewOrderDetails(order.orderNumber)">
          <span>View Details</span>
          <span class="material-symbols-outlined">arrow_forward</span>
        </button>
      </div>

      <!-- Product Images -->
      @if (order.items && order.items.length > 0) {
      <div class="order-products">
        <div class="products-gallery">
          @for (item of getProductImages(order); track item.id) {
          <div class="product-thumbnail">
            <img [src]="item.productImage || 'assets/placeholder.jpg'" [alt]="item.productName" loading="lazy" />
          </div>
          }

          <!-- Extra Products Badge -->
          @if (getExtraProductsCount(order) > 0) {
          <div class="extra-products-badge">
            <span>+{{ getExtraProductsCount(order) }}</span>
          </div>
          }
        </div>
      </div>
      }
    </div>
    }
  </div>
  }

  <!-- Empty State -->
  @if (!loading() && filteredOrders().length === 0) {
  <div class="empty-state">
    <span class="material-symbols-outlined">receipt</span>
    <h3>No orders found</h3>
    <p>
      {{
      selectedDateFilter() === 'all'
      ? 'You haven\'t placed any orders yet.'
      : 'No orders found for the selected period.'
      }}
    </p>
    <a href="/client/home" class="btn btn-primary">
      <span class="material-symbols-outlined">shopping_bag</span>
      Start Shopping
    </a>
  </div>
  }
</div>